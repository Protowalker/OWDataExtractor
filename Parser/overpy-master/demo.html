<!--
 * This file is part of OverPy (https://github.com/Zezombye/overpy).
 * Copyright (c) 2019 Zezombye.
 * 
 * This program is free software: you can redistribute it and/or modify  
 * it under the terms of the GNU General Public License as published by  
 * the Free Software Foundation, version 3.
 *
 * This program is distributed in the hope that it will be useful, but 
 * WITHOUT ANY WARRANTY; without even the implied warranty of 
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU 
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License 
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
-->
<!--stfu firefox -->
<meta charset="utf-8">
<link rel="icon" type="image/png" href="VS Code Extension/img/overpy.ico"/>

<style>
textarea {
	resize: vertical;
    -moz-tab-size: 4;
      -o-tab-size: 4;
         tab-size: 4;
}

body, textarea {
	color: #CCCCCC;
	background-color: #222222;
	scrollbar-color: #CCCCCC #222222;
}

a {
	color: lightblue;
}

</style>

<center>
	<a href="https://github.com/Zezombye/overpy"><h1>OverPy v6.0 language demo by Zezombye</h1></a>
	<p><a href="https://github.com/Zezombye/overpy/blob/master/FUNCTIONS.md">Function documentation</a> | <button onclick="demoAddText();">Add example text</button> | Language: 
		<select id="languageInput">
			<option value="en-US">English</option>
			<option value="de-DE">Deutsch</option>
			<option value="es-ES">Español (EU)</option>
			<option value="es-MX">Español (AL)</option>
			<option value="fr-FR">Français</option>
			<option value="it-IT">Italiano</option>
			<option value="ja-JP">日本語</option>
			<option value="ko-KR">한국어</option>
			<option value="pl-PL">Polski</option>
			<option value="pt-BR">Português</option>
			<option value="ru-RU">Русский</option>
			<option value="zh-CN">简体中文</option>
			<option value="zh-TW">繁體中文</option>
		</select>
	</p>
    
	<div id="workshop-text" style="float:left; width:33%;">
		<p>Workshop text</p>
		<button onclick="demoDecompile()">Decompile</button>
		<textarea id="workshop-textarea" onkeyup="getTextareaLineNumber(this, 'workshop');" onmouseup="this.onkeyup();" rows="20" style="width:100%;" wrap="off" placeholder="Note: the decompiler only supports code copied directly from Overwatch.&#10;&#10;If you wish to decompile code generated by a third-party tool (including OverPy), paste it into Overwatch and copy it."></textarea> 
		<p style="float:left;">line <span id="workshop-textarea-line-number"></span>, col <span id="workshop-textarea-col-number"></span></p>
	</div>
	
	<div id="overpy-text" style="float:left; width:33%;">
		<p>OverPy text</p>
		<button onclick="demoCompile()">Compile</button>
		<textarea id="overpy-textarea" onkeyup="getTextareaLineNumber(this, 'overpy');" onmouseup="this.onkeyup();" rows="20" style="width:100%;" wrap="off"></textarea> 
		<p style="float:left;">line <span id="overpy-textarea-line-number"></span>, col <span id="overpy-textarea-col-number"></span></p>
	</div>
	
	<div id="compiled-text" style="float:right; width:34%;">
		<p>Compiled text</p>
		<button style="visibility: hidden;">hidden</button>
		<textarea id="compiled-textarea" onkeyup="getTextareaLineNumber(this, 'compiled');" onmouseup="this.onkeyup();" rows="20" style="width:100%;" wrap="off"></textarea> 
		<p style="float:left;">line <span id="compiled-textarea-line-number"></span>, col <span id="compiled-textarea-col-number"></span></p>
	</div>
</center>


<script src="src/utils/other.js"></script>

<script src="src/data/opy/stringEntities.js"></script>
<script src="src/data/opy/constants.js"></script>
<script src="src/data/opy/internalFunctions.js"></script>
<script src="src/data/opy/functions.js"></script>
<script src="src/data/opy/keywords.js"></script>
<script src="src/data/opy/memberFunctions.js"></script>
<script src="src/data/opy/preprocessing.js"></script>
<script src="src/data/actions.js"></script>
<script src="src/data/values.js"></script>
<script src="src/data/maps.js"></script>
<script src="src/data/heroes.js"></script>
<script src="src/data/gamemodes.js"></script>
<script src="src/data/constants.js"></script>
<script src="src/data/other.js"></script>
<script src="src/data/customGameSettings.js"></script>
<script src="src/data/opy/annotations.js"></script>

<script src="src/globalVars.js"></script>

<script src="src/utils/ast.js"></script>
<script src="src/utils/types.js"></script>
<script src="src/utils/compilation.js"></script>
<script src="src/utils/decompilation.js"></script>
<script src="src/utils/file.js"></script>
<script src="src/utils/logging.js"></script>
<script src="src/utils/optimization.js"></script>
<script src="src/utils/strings.js"></script>
<script src="src/utils/translation.js"></script>
<script src="src/utils/varNames.js"></script>
<script src="src/utils/tokens.js"></script>

<script src="src/decompiler/decompileTest.js"></script>
<script src="src/decompiler/workshopToAst.js"></script>
<script src="src/decompiler/astToOpy.js"></script>
<script src="src/decompiler/decompiler.js"></script>

<script src="src/compiler/obfuscation.js"></script>
<script src="src/compiler/functions/__add__.js"></script>
<script src="src/compiler/functions/__and__.js"></script>
<script src="src/compiler/functions/__append__.js"></script>
<script src="src/compiler/functions/__array__.js"></script>
<script src="src/compiler/functions/__arraySlice__.js"></script>
<script src="src/compiler/functions/__assignTo__.js"></script>
<script src="src/compiler/functions/__button__.js"></script>
<script src="src/compiler/functions/__del__.js"></script>
<script src="src/compiler/functions/__dict__.js"></script>
<script src="src/compiler/functions/__distanceTo__.js"></script>
<script src="src/compiler/functions/__divide__.js"></script>
<script src="src/compiler/functions/__doWhile__.js"></script>
<script src="src/compiler/functions/__elif__.js"></script>
<script src="src/compiler/functions/__else__.js"></script>
<script src="src/compiler/functions/__equals__.js"></script>
<script src="src/compiler/functions/__for__.js"></script>
<script src="src/compiler/functions/__format__.js"></script>
<script src="src/compiler/functions/__filteredArray__.js"></script>
<script src="src/compiler/functions/__gamemode__.js"></script>
<script src="src/compiler/functions/__greaterThan__.js"></script>
<script src="src/compiler/functions/__greaterThanOrEquals__.js"></script>
<script src="src/compiler/functions/__hero__.js"></script>
<script src="src/compiler/functions/__if__.js"></script>
<script src="src/compiler/functions/__ifThenElse__.js"></script>
<script src="src/compiler/functions/__indexOfArrayValue__.js"></script>
<script src="src/compiler/functions/__inequals__.js"></script>
<script src="src/compiler/functions/__lastOf__.js"></script>
<script src="src/compiler/functions/__lessThan__.js"></script>
<script src="src/compiler/functions/__lessThanOrEquals__.js"></script>
<script src="src/compiler/functions/__map__.js"></script>
<script src="src/compiler/functions/__mappedArray__.js"></script>
<script src="src/compiler/functions/__modulo__.js"></script>
<script src="src/compiler/functions/__multiply__.js"></script>
<script src="src/compiler/functions/__negate__.js"></script>
<script src="src/compiler/functions/__number__.js"></script>
<script src="src/compiler/functions/__not__.js"></script>
<script src="src/compiler/functions/__or__.js"></script>
<script src="src/compiler/functions/__raiseToPower__.js"></script>
<script src="src/compiler/functions/__remove__.js"></script>
<script src="src/compiler/functions/__rule__.js"></script>
<script src="src/compiler/functions/__skip__.js"></script>
<script src="src/compiler/functions/__subtract__.js"></script>
<script src="src/compiler/functions/__switch__.js"></script>
<script src="src/compiler/functions/__team__.js"></script>
<script src="src/compiler/functions/__valueInArray__.js"></script>
<script src="src/compiler/functions/__wait__.js"></script>
<script src="src/compiler/functions/__while__.js"></script>
<script src="src/compiler/functions/__xComponentOf__.js"></script>
<script src="src/compiler/functions/__yComponentOf__.js"></script>
<script src="src/compiler/functions/__zComponentOf__.js"></script>
<script src="src/compiler/functions/_&addToScore.js"></script>
<script src="src/compiler/functions/_&setStatusEffect.js"></script>
<script src="src/compiler/functions/_&setUltCharge.js"></script>
<script src="src/compiler/functions/abs.js"></script>
<script src="src/compiler/functions/acos.js"></script>
<script src="src/compiler/functions/acosDeg.js"></script>
<script src="src/compiler/functions/addToTeamScore.js"></script>
<script src="src/compiler/functions/all.js"></script>
<script src="src/compiler/functions/any.js"></script>
<script src="src/compiler/functions/asin.js"></script>
<script src="src/compiler/functions/asinDeg.js"></script>
<script src="src/compiler/functions/atan2.js"></script>
<script src="src/compiler/functions/atan2Deg.js"></script>
<script src="src/compiler/functions/break.js"></script>
<script src="src/compiler/functions/ceil.js"></script>
<script src="src/compiler/functions/continue.js"></script>
<script src="src/compiler/functions/cos.js"></script>
<script src="src/compiler/functions/cosDeg.js"></script>
<script src="src/compiler/functions/createBeam.js"></script>
<script src="src/compiler/functions/createWorkshopSetting.js"></script>
<script src="src/compiler/functions/crossProduct.js"></script>
<script src="src/compiler/functions/directionTowards.js"></script>
<script src="src/compiler/functions/disableInspector.js"></script>
<script src="src/compiler/functions/distance.js"></script>
<script src="src/compiler/functions/dotProduct.js"></script>
<script src="src/compiler/functions/enableInspector.js"></script>
<script src="src/compiler/functions/floor.js"></script>
<script src="src/compiler/functions/getAllPlayers.js"></script>
<script src="src/compiler/functions/getOppositeTeam.js"></script>
<script src="src/compiler/functions/len.js"></script>
<script src="src/compiler/functions/lineIntersectsSphere.js"></script>
<script src="src/compiler/functions/log.js"></script>
<script src="src/compiler/functions/max.js"></script>
<script src="src/compiler/functions/min.js"></script>
<script src="src/compiler/functions/normalize.js"></script>
<script src="src/compiler/functions/print.js"></script>
<script src="src/compiler/functions/round.js"></script>
<script src="src/compiler/functions/sin.js"></script>
<script src="src/compiler/functions/sinDeg.js"></script>
<script src="src/compiler/functions/sorted.js"></script>
<script src="src/compiler/functions/sqrt.js"></script>
<script src="src/compiler/functions/tan.js"></script>
<script src="src/compiler/functions/tanDeg.js"></script>
<script src="src/compiler/functions/vect.js"></script>
<script src="src/compiler/functions/vectorTowards.js"></script>
<script src="src/compiler/tokenizer.js"></script>
<script src="src/compiler/astParser.js"></script>
<script src="src/compiler/astToWorkshop.js"></script>
<script src="src/compiler/parser.js"></script>
<script src="src/compiler/compiler.js"></script>
<script src="src/data/localizedStrings.js"></script>

<script>

function getTextareaLineNumber(textarea, name) {
		
	document.getElementById(name+"-textarea-line-number").innerHTML = textarea.value.substr(0, textarea.selectionStart).split("\n").length;
	document.getElementById(name+"-textarea-col-number").innerHTML = textarea.selectionStart - textarea.value.substr(0, textarea.selectionStart).lastIndexOf("\n");
}

function demoDecompile() {
	
    var str = "";
    var language = document.getElementById("languageInput").value;
    
	try {
        str = decompileAllRules(document.getElementById("workshop-textarea").value, language);
	} catch (e) {
		console.log(e);
		str = e;
	}
	document.getElementById("overpy-textarea").value = str;
}

function demoCompile() {
	
	var str = "";
    var language = document.getElementById("languageInput").value;
	try {
		compilationResult = compile(document.getElementById("overpy-textarea").value, language);
		str = compilationResult.result;
		if (compilationResult.encounteredWarnings.length > 0) {
			var strWarn = "/* Warnings were encountered:\n\n"
			for (var warning of compilationResult.encounteredWarnings) {
				strWarn += " - "+warning+"\n\n";
			}
			strWarn += "*/\n";
			str = strWarn+str;
		}
	} catch (e) {
		console.log(e);
		str = e;
	}
	document.getElementById("compiled-textarea").value = str;
}

function demoAddText() {
	document.getElementById("workshop-textarea").value = decompileTest;
	document.getElementById("overpy-textarea").value = "";
	document.getElementById("compiled-textarea").value = "";
	
}

</script>